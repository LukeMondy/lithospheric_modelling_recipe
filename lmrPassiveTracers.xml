<?xml version="1.0" encoding="UTF-8"?>
<StGermainData xmlns="http://www.vpac.org/StGermain/XML_IO_Handler/Jun2003">
    
    <struct name="components" mergeType="merge">  
    
        <!-- === Passive Tracer geometries ==================================================== -->
        
        <struct name="surfaceTracerLayout">
            <!-- Generates a line of passive tracers across the surface -->
            <param name="Type">LineParticleLayout</param>
            <param name="totalInitialParticles">@elementResI</param> <!-- 1 tracer per element -->
            <list name="vertices">
                <asciidata>
                    <columnDefinition name = "x" type="double" units="km"/>
                    <columnDefinition name = "y" type="double" units="km"/>
                    @minX   0 
                    @maxX   0
                </asciidata>
            </list>
        </struct>
        
        <struct name="mohoTracerLayout">               
            <param name="Type">LineParticleLayout</param>
            <param name="totalInitialParticles">@elementResI</param>
            <list name="vertices">
                <asciidata>
                    <columnDefinition name = "x" type="double" units="km"/>
                    <columnDefinition name = "y" type="double" units="km"/>
                    @minX   -40
                    @maxX   -40
                </asciidata>
            </list>
        </struct>
        
        <struct name="user_passiveTracerLayout">
            <param name="Type">UnionParticleLayout</param>
            <list name="ParticleLayoutList">
                <param>surfaceTracerLayout</param>	
                <param>mohoTracerLayout</param>
            </list>
        </struct>
        <!-- ==================================================================================== -->
        
        
        
        <!-- === Numerical implementation ======================================================= -->
        <struct name="user_passiveSwarmMovementHandler">
            <param name="Type">ParticleMovementHandler</param>
        </struct>
        <struct name="user_ElementCellLayoutTracer">
            <param name="Type">ElementCellLayout</param>
            <param name="Mesh">linearMesh</param>
        </struct>
        <struct name="user_passiveTracerSwarm">
            <param name="Type">MaterialPointsSwarm</param>
            <param name="CellLayout">user_ElementCellLayoutTracer</param>
            <param name="ParticleLayout">user_passiveTracerLayout</param>
            <param name="FiniteElement_Mesh">linearMesh</param>
            <param name="FeMesh">elementMesh</param>
            <list name="ParticleCommHandlers">
                <param>user_passiveSwarmMovementHandler</param>
            </list>
        </struct>
        
        <struct name="passiveTracerAdvect">
            <param name="Type">SwarmAdvector</param>
            <param name="Swarm">user_passiveTracerSwarm</param>
            <param name="TimeIntegrator">timeIntegrator</param>
            <param name="VelocityField">VelocityField</param>
        </struct>
        <!-- ==================================================================================== -->
        
        
        
        <!-- === Output controls ================================================================ -->        
        <!-- NOTE: "Output controls" must come *after* the "Numerical implementation" XML -->

        <struct name="passiveswarmOutputs">
            <!-- Generates 1 file per tracer. Each file contains the timesteps
                 and data for that tracer. NOTE: filename is as such:
                 particle<cpu>.<localCPUid>.<struct name>.dat -->
            <param name="Type">Underworld_SwarmOutput</param>
            <param name="Swarm">user_passiveTracerSwarm</param>
            <param name="mode">PARTICLE_TRACE</param>
            <list name="FeVariables">
                <param>recoveredPressureField</param>
                <param>TemperatureField</param>
                <param>recoveredStrainRateInvariantField</param>
                <param>recoveredDeviatoricStressInvariantField</param>
            </list>
        </struct>
        
        <!-- ==================================================================================== -->
        
    </struct>
    
    
</StGermainData>
